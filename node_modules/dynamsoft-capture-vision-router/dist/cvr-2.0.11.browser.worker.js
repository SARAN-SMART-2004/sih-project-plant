/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Capture Vision Router JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2023, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 2.0.11 (js 20230823)
 * @fileoverview Dynamsoft JavaScript Library for Capture Vision
 * More info on cvr JS: https://www.dynamsoft.com/capture-vision-router/sdk-javascript/
 */
!function(){"use strict";const e="undefined"==typeof self,t=e?{}:self,r=e=>e&&"object"==typeof e&&"function"==typeof e.then;class n extends Promise{constructor(e){let t,n;super(((e,r)=>{t=e,n=r})),this._s="pending",this.resolve=e=>{this.isPending&&(r(e)?this.task=e:(this._s="fulfilled",t(e)))},this.reject=e=>{this.isPending&&(this._s="rejected",n(e))},this.task=e}get status(){return this._s}get isPending(){return"pending"===this._s}get isFulfilled(){return"fulfilled"===this._s}get isRejected(){return"rejected"===this._s}get task(){return this._task}set task(e){let t;this._task=e,r(e)?t=e:"function"==typeof e&&(t=new Promise(e)),t&&(async()=>{try{const r=await t;e===this._task&&this.resolve(r)}catch(t){e===this._task&&this.reject(t)}})()}get isEmpty(){return null==this._task}}let o,_,i,s,a;"undefined"!=typeof navigator&&(o=navigator,_=o.userAgent,i=o.platform,s=o.mediaDevices),function(){if(!e){const e={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:o.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},t={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:i,search:"Win"},Mac:{str:i},Linux:{str:i}};let r="unknownBrowser",n=0,s="unknownOS";for(let t in e){const o=e[t]||{};let i=o.str||_,s=o.search||t,a=o.verStr||_,E=o.verSearch||t;if(E instanceof Array||(E=[E]),-1!=i.indexOf(s)){r=t;for(let e of E){let t=a.indexOf(e);if(-1!=t){n=parseFloat(a.substring(t+e.length+1));break}}break}}for(let e in t){const r=t[e]||{};let n=r.str||_,o=r.search||e;if(-1!=n.indexOf(o)){s=e;break}}"Linux"==s&&-1!=_.indexOf("Windows NT")&&(s="HarmonyOS"),a={browser:r,version:n,OS:s}}e&&(a={browser:"ssr",version:0,OS:"ssr"})}(),s&&s.getUserMedia;const E="Chrome"===a.browser&&a.version>66||"Safari"===a.browser&&a.version>13||"OPR"===a.browser&&a.version>43||"Edge"===a.browser&&a.version>15;var c=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function I(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}function d(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function u(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function l(e){return"string"!=typeof e&&(console.warn(`${e} used as a key, but it is not a string.`),e=String(e)),e}function C(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}const T="local-forage-detect-blob-support";let N;const f={},A=Object.prototype.toString,m="readonly",D="readwrite";function S(e){return"boolean"==typeof N?Promise.resolve(N):function(e){return new Promise((function(t){var r=e.transaction(T,D),n=I([""]);r.objectStore(T).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return N=e,N}))}function R(e){var t=f[e.name],r={};r.promise=new Promise((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function h(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function O(e,t){var r=f[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function g(e,t){return new Promise((function(r,n){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);R(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var _=c.open.apply(c,o);t&&(_.onupgradeneeded=function(t){var r=_.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(T)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),_.onerror=function(e){e.preventDefault(),n(_.error)},_.onsuccess=function(){var t=_.result;t.onversionchange=function(e){e.target.close()},r(t),h(e)}}))}function L(e){return g(e,!1)}function p(e){return g(e,!0)}function y(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var _=e.db.version+1;_>e.version&&(e.version=_)}return!0}return!1}function b(e){var t=function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}(atob(e.data));return I([t],{type:e.type})}function M(e){var t=this,r=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return u(r,e,e),r}function v(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return Promise.resolve().then((()=>{if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),p(e)})).then((()=>function(e){R(e);for(var t=f[e.name],r=t.forages,n=0;n<r.length;n++){const e=r[n];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return e.db=null,L(e).then((t=>(e.db=t,y(e)?p(e):t))).then((n=>{e.db=t.db=n;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=n})).catch((t=>{throw O(e,t),t}))}(e).then((function(){v(e,t,r,n-1)})))).catch(r);r(o)}}var U={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=f[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[r.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=M);var _=[];function i(){return Promise.resolve()}for(var s=0;s<o.forages.length;s++){var a=o.forages[s];a!==t&&_.push(a._initReady().catch(i))}var E=o.forages.slice(0);return Promise.all(_).then((function(){return r.db=o.db,L(r)})).then((function(e){return r.db=e,y(r,t._defaultConfig.version)?p(r):e})).then((function(e){r.db=o.db=e,t._dbInfo=r;for(var n=0;n<E.length;n++){var _=E[n];_!==t&&(_._dbInfo.db=r.db,_._dbInfo.version=r.version)}}))},_support:function(){try{if(!c||!c.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),getItem:function(e,t){var r=this;e=l(e);var n=new Promise((function(t,n){r.ready().then((function(){v(r._dbInfo,m,(function(o,_){if(o)return n(o);try{var i=_.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),function(e){return e&&e.__local_forage_encoded_blob}(e)&&(e=b(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n},setItem:function(e,t,r){var n=this;e=l(e);var o=new Promise((function(r,o){var _;n.ready().then((function(){return _=n._dbInfo,"[object Blob]"===A.call(t)?S(_.db).then((function(e){return e?t:(r=t,new Promise((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){v(n._dbInfo,D,(function(_,i){if(_)return o(_);try{var s=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var a=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),r(t)},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return d(o,r),o},removeItem:function(e,t){var r=this;e=l(e);var n=new Promise((function(t,n){r.ready().then((function(){v(r._dbInfo,D,(function(o,_){if(o)return n(o);try{var i=_.objectStore(r._dbInfo.storeName).delete(e);_.oncomplete=function(){t()},_.onerror=function(){n(i.error)},_.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n},clear:function(e){var t=this,r=new Promise((function(e,r){t.ready().then((function(){v(t._dbInfo,D,(function(n,o){if(n)return r(n);try{var _=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=_.error?_.error:_.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return d(r,e),r},length:function(e){var t=this,r=new Promise((function(e,r){t.ready().then((function(){v(t._dbInfo,m,(function(n,o){if(n)return r(n);try{var _=o.objectStore(t._dbInfo.storeName).count();_.onsuccess=function(){e(_.result)},_.onerror=function(){r(_.error)}}catch(e){r(e)}}))})).catch(r)}));return d(r,e),r},keys:function(e){var t=this,r=new Promise((function(e,r){t.ready().then((function(){v(t._dbInfo,m,(function(n,o){if(n)return r(n);try{var _=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];_.onsuccess=function(){var t=_.result;t?(i.push(t.key),t.continue()):e(i)},_.onerror=function(){r(_.error)}}catch(e){r(e)}}))})).catch(r)}));return d(r,e),r},dropInstance:function(e,t){t=C.apply(this,arguments);var r,n=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName),e.name){const t=e.name===n.name&&this._dbInfo.db?Promise.resolve(this._dbInfo.db):L(e).then((t=>{const r=f[e.name],n=r.forages;r.db=t;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=t;return t}));r=e.storeName?t.then((t=>{if(!t.objectStoreNames.contains(e.storeName))return;const r=t.version+1;R(e);const n=f[e.name],o=n.forages;t.close();for(let e=0;e<o.length;e++){const t=o[e];t._dbInfo.db=null,t._dbInfo.version=r}const _=new Promise(((t,n)=>{const o=c.open(e.name,r);o.onerror=e=>{o.result.close(),n(e)},o.onupgradeneeded=()=>{o.result.deleteObjectStore(e.storeName)},o.onsuccess=()=>{const e=o.result;e.close(),t(e)}}));return _.then((e=>{n.db=e;for(let t=0;t<o.length;t++){const r=o[t];r._dbInfo.db=e,h(r._dbInfo)}})).catch((t=>{throw(O(e,t)||Promise.resolve()).catch((()=>{})),t}))})):t.then((t=>{R(e);const r=f[e.name],n=r.forages;t.close();for(var o=0;o<n.length;o++){n[o]._dbInfo.db=null}const _=new Promise(((t,r)=>{var n=c.deleteDatabase(e.name);n.onerror=()=>{const e=n.result;e&&e.close(),r(n.error)},n.onblocked=()=>{console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=()=>{const e=n.result;e&&e.close(),t(e)}}));return _.then((e=>{r.db=e;for(var t=0;t<n.length;t++){h(n[t]._dbInfo)}})).catch((t=>{throw(O(e,t)||Promise.resolve()).catch((()=>{})),t}))}))}else r=Promise.reject("Invalid arguments");return d(r,t),r}};const w=new Map;function P(e,t){let r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}var F={_driver:"tempStorageWrapper",_initStorage:async function(e){const t={};if(e)for(let r in e)t[r]=e[r];const r=t.keyPrefix=P(e,this._defaultConfig);this._dbInfo=t,w.has(r)||w.set(r,new Map)},getItem:function(e,t){e=l(e);const r=this.ready().then((()=>w.get(this._dbInfo.keyPrefix).get(e)));return d(r,t),r},setItem:function(e,t,r){e=l(e);const n=this.ready().then((()=>(void 0===t&&(t=null),w.get(this._dbInfo.keyPrefix).set(e,t),t)));return d(n,r),n},removeItem:function(e,t){e=l(e);const r=this.ready().then((()=>{w.get(this._dbInfo.keyPrefix).delete(e)}));return d(r,t),r},clear:function(e){const t=this.ready().then((()=>{const e=this._dbInfo.keyPrefix;w.has(e)&&w.delete(e)}));return d(t,e),t},length:function(e){const t=this.ready().then((()=>w.get(this._dbInfo.keyPrefix).size));return d(t,e),t},keys:function(e){const t=this.ready().then((()=>[...w.get(this._dbInfo.keyPrefix).keys()]));return d(t,e),t},dropInstance:function(e,t){if(t=C.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){const t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}let r;return r=e.name?new Promise((t=>{e.storeName?t(P(e,this._defaultConfig)):t(`${e.name}/`)})).then((e=>{w.delete(e)})):Promise.reject("Invalid arguments"),d(r,t),r}};const G=(e,t)=>e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t),V=(e,t)=>{const r=e.length;let n=0;for(;n<r;){if(G(e[n],t))return!0;n++}return!1},B=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},x={},k={},H={INDEXEDDB:U,TEMPSTORAGE:F},Y=[H.INDEXEDDB._driver,H.TEMPSTORAGE._driver],W=["dropInstance"],Z=["clear","getItem","keys","length","removeItem","setItem"].concat(W),X={description:"",driver:Y.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function j(e,t){e[t]=function(){const r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function J(){for(let e=1;e<arguments.length;e++){const t=arguments[e];if(t)for(let e in t)t.hasOwnProperty(e)&&(B(t[e])?arguments[0][e]=t[e].slice():arguments[0][e]=t[e])}return arguments[0]}class z{constructor(e){for(let e in H)if(H.hasOwnProperty(e)){const t=H[e],r=t._driver;this[e]=r,x[r]||this.defineDriver(t)}this._defaultConfig=J({},X),this._config=J({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((()=>{}))}config(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(let t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config}defineDriver(e,t,r){const n=new Promise((function(t,r){try{const n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);const _=Z.concat("_initStorage");for(let t=0,n=_.length;t<n;t++){const n=_[t];if((!V(W,n)||e[n])&&"function"!=typeof e[n])return void r(o)}const i=function(){const t=function(e){return function(){const t=new Error(`Method ${e} is not implemented by the current driver`),r=Promise.reject(t);return d(r,arguments[arguments.length-1]),r}};for(let r=0,n=W.length;r<n;r++){const n=W[r];e[n]||(e[n]=t(n))}};i();const s=function(r){x[n]&&console.info(`Redefining LocalForage driver: ${n}`),x[n]=e,k[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(s,r):s(!!e._support):s(!0)}catch(e){r(e)}}));return u(n,t,r),n}driver(){return this._driver||null}getDriver(e,t,r){const n=x[e]?Promise.resolve(x[e]):Promise.reject(new Error("Driver not found."));return u(n,t,r),n}ready(e){const t=this,r=t._driverSet.then((()=>(null===t._ready&&(t._ready=t._initDriver()),t._ready)));return u(r,e,e),r}setDriver(e,t,r){const n=this;B(e)||(e=[e]);const o=this._getSupportedDrivers(e);function _(){n._config.driver=n.driver()}function i(e){return n._extend(e),_(),n._ready=n._initStorage(n._config),n._ready}const s=null!==this._driverSet?this._driverSet.catch((()=>Promise.resolve())):Promise.resolve();return this._driverSet=s.then((()=>{const e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((e=>{n._driver=e._driver,_(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){let t=0;return function r(){for(;t<e.length;){let o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(i).catch(r)}_();const o=new Error("No available storage method found.");return n._driverSet=Promise.reject(o),n._driverSet}()}}(o)}))})).catch((()=>{_();const e=new Error("No available storage method found.");return n._driverSet=Promise.reject(e),n._driverSet})),u(this._driverSet,t,r),this._driverSet}supports(e){return!!k[e]}_extend(e){J(this,e)}_getSupportedDrivers(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];this.supports(n)&&t.push(n)}return t}_wrapLibraryMethodsWithReady(){for(let e=0,t=Z.length;e<t;e++)j(this,Z[e])}createInstance(e){return new z(e)}}var K=new z;Date.prototype.kUtilFormat=function(e){const t={"M+":this.getUTCMonth()+1,"d+":this.getUTCDate(),"H+":this.getUTCHours(),"h+":this.getUTCHours()%12||12,"m+":this.getUTCMinutes(),"s+":this.getUTCSeconds(),"q+":Math.floor((this.getUTCMonth()+3)/3),"S+":this.getUTCMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getUTCFullYear()+"").substr(4-RegExp.$1.length)));for(let r in t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("000"+t[r]).substr(("000"+t[r]).length-RegExp.$1.length)));return e};let $=e=>{let r,o,_,i,s,a,c,I,d,u=t.btoa,l=t.atob,C=e.bd,T=e.dm;const N=["https://mlts.dynamsoft.com/","https://slts.dynamsoft.com/"];let f,A,m,D,S,R,h,O,g,L,p,y,b,M,v,U=N,w=!1,P=Promise.resolve(),F=e.log&&((...t)=>{try{e.log.apply(null,t)}catch(e){setTimeout((()=>{throw e}),0)}})||(()=>{}),G=C&&F||(()=>{}),V=e=>e.join(""),B={a:[80,88,27,82,145,164,199,211],b:[187,87,89,128,150,44,190,213],c:[89,51,74,53,99,72,82,118],d:[99,181,118,158,215,103,76,117],e:[99,51,86,105,100,71,120,108],f:[97,87,49,119,98,51,74,48,83,50,86,53],g:[81,85,86,84,76,85,100,68,84,81,32,32],h:[90,87,53,106,99,110,108,119,100,65,32,32],i:[90,71,86,106,99,110,108,119,100,65,32,32],j:[97,88,89,32],k:[29,83,122,137,5,180,157,114],l:[100,71,70,110,84,71,86,117,90,51,82,111]},x=()=>t[V(B.c)][V(B.e)][V(B.f)]("raw",new Uint8Array(B.a.concat(B.b,B.d,B.k)),V(B.g),!0,[V(B.h),V(B.i)]),k=e=>l(l(e.replace(/\n/g,"+").replace(/\s/g,"=")).substring(1)),H=e=>u(String.fromCharCode(97+25*Math.random())+u(e)).replace(/\+/g,"\n").replace(/=/g," "),Y=()=>{if(t.crypto){let e=new Uint8Array(36);t.crypto.getRandomValues(e);let r="";for(let t=0;t<36;++t){let n=e[t]%36;r+=n<10?n:String.fromCharCode(n+87)}return r}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))};const W="Failed to connect to the Dynamsoft License Server: ",Z={dlsErrorAndCacheExpire:W+"The cached license has expired. Please get connected to the network as soon as possible or contact the site administrator for more information.",publicTrialNetworkTimeout:W+"network timed out. Check your Internet connection or [contact Dynamsoft](https://www.dynamsoft.com/company/contact/) for more information.",networkTimeout:W+"network timed out. Check your Internet connection or contact the site administrator for more information.",publicTrialFailConnect:W+"network connection error. Check your Internet connection or [contact Dynamsoft](https://www.dynamsoft.com/company/contact/) for more information.",failConnect:W+"network connection error. Check your Internet connection or contact the site administrator for more information.",checkLocalTime:"Your system date and time appear to have been changed, causing the license to fail. Please correct the system data and time and try again.",idbTimeout:"Failed to open indexedDB: Timeout."};let X,j,J,z,$=async()=>{if(X)return X;X=new n,await(async()=>{h||(h=K)})(),await Promise.race([(async()=>{let e=await h.createInstance({name:"dynamjssdkhello"});await e.setItem("dynamjssdkhello","available")})(),new Promise(((e,t)=>{setTimeout((()=>t(new Error(Z.idbTimeout))),5e3)}))]),g=await h.createInstance({name:"dynamdlsinfo"}),L=u(u("v2")+String.fromCharCode(T.charCodeAt(T.length/2)+1)+u(T));try{let e=await g.getItem(L);if(!e){let t=await h.createInstance({name:"dynamltsinfo"});e=await t.getItem(L),e&&await g.setItem(L,e)}e&&([c,S]=JSON.parse(await k(e)))}catch(e){}try{null==c&&(c=Y(),g.setItem(L,await H(JSON.stringify([c,null]))))}catch(e){}X.resolve()},Q=async e=>{if(J=Date.now(),j)return j;j=new n;try{let t={pd:r,vm:_,v:o,dt:a||"browser",ed:"javascript",cu:c,ad:T,os:I,fn:d};m&&(t.rmk=m),i&&(-1!=i.indexOf("-")?t.hs=i:t.og=i);let n={};if(S){let e=await g.getItem(L);e&&([c,S]=JSON.parse(await k(e))),n["lts-time"]=S}A&&(t.sp=A);let E=await Promise.race([(async()=>{let r,o=(new Date).kUtilFormat("yyyy-MM-ddTHH:mm:ss.SSSZ");S&&(g.setItem(L,await H(JSON.stringify([c,o]))),S=o);let _="auth/?ext="+encodeURIComponent(u(JSON.stringify(t)));D&&(_+="&v="+encodeURIComponent(D));let i,a=!1,E=!1,I=async e=>{if(e&&!e.ok)try{let t=await e.text();if(t){let e=JSON.parse(t);e.errorCode&&(i=e,e.errorCode>100&&e.errorCode<200&&(s=null,a=!0,E=!0))}}catch(e){}};try{r=await Promise.race([fetch(U[0]+_,{headers:n,cache:e?"reload":"default",mode:"cors"}),new Promise(((e,t)=>setTimeout(t,1e4)))]),await I(r)}catch(e){}if(!(s||r&&r.ok||a))try{r=await Promise.race([fetch(U[1]+_,{headers:n,mode:"cors"}),new Promise(((e,t)=>setTimeout(t,3e4)))]),await I(r)}catch(e){}if(!(s||r&&r.ok||a))try{r=await Promise.race([fetch(U[0]+_,{headers:n,mode:"cors"}),new Promise(((e,t)=>setTimeout(t,3e4)))]),await I(r)}catch(e){}i&&151==i.errorCode&&(g.removeItem(L),g.removeItem(p),c=Y(),t.cu=c,S=void 0,_="auth/?ext="+encodeURIComponent(u(JSON.stringify(t))),r=await Promise.race([fetch(U[0]+_,{headers:n,mode:"cors"}),new Promise(((e,t)=>setTimeout(t,3e4)))]),await I(r)),(()=>{if(!r||!r.ok){let e;E&&g.setItem(p,""),i?111==i.errorCode?e=i.message:(e=i.message.trim(),e.endsWith(".")||(e+="."),e=f?`An error occurred during authorization: ${e} [Contact Dynamsoft](https://www.dynamsoft.com/company/contact/) for more information.`:`An error occurred during authorization: ${e} Contact the site administrator for more information.`):e=f?Z.publicTrialFailConnect:Z.failConnect;let t=Error(e);throw i&&i.errorCode&&(t.ltsErrorCode=i.errorCode),t}})();let d=await r.text();try{S||(g.setItem(L,await H(JSON.stringify([c,o]))),S=o),g.setItem(p,d)}catch(e){}return d})(),new Promise(((e,t)=>{let r;r=f?Z.publicTrialNetworkTimeout:Z.networkTimeout,setTimeout((()=>t(new Error(r))),s?3e3:15e3)}))]);s=E}catch(e){C&&console.error(e),R=e}j.resolve(),j=null},q=async()=>{z||(z=(async()=>{if(G(c),!s){if(!w)throw F(R.message),R;return}let e={dm:T};C&&(e.bd=!0),e.brtk=!0,e.ls=U[0],i&&(-1!=i.indexOf("-")?e.hs=i:e.og=i),e.cu=c,d&&(e.fn=d),r&&(e.pd=r),o&&(e.v=o),a&&(e.dt=a),I&&(e.os=I),m&&(e.rmk=m),G(s);try{let r=JSON.parse(await(async e=>{if(t[V(B.c)]&&t[V(B.c)][V(B.e)]&&t[V(B.c)][V(B.e)][V(B.f)]){let r=l(e),n=new Uint8Array(r.length);for(let e=0;e<r.length;++e)n[e]=r.charCodeAt(e);let o=n.subarray(0,12),_=n.subarray(o.length);v||(v=await x());let i=await t[V(B.c)][V(B.e)][V(B.i)]({name:V(B.g),[V(B.j)]:o,[V(B.l)]:128},v,_);return String.fromCharCode.apply(null,new Uint8Array(i))}})(s));r.ba&&(e.ba=r.ba),r.usu&&(e.usu=r.usu),r.trial&&(e.trial=r.trial),r.its&&(e.its=r.its),1==e.trial&&r.msg?e.msg=r.msg:R?e.msg=R.message||R:r.msg&&(e.msg=r.msg),e.ar=r.in,e.bafc=!!R}catch(e){}G(e);try{await y(e)}catch(e){G("error updl")}await ee(),w||(w=!0),z=null})()),await z},ee=async()=>{let e=(new Date).kUtilFormat("yyyy-MM-ddTHH:mm:ss.SSSZ"),t=await M();if(G(t),t&&t<e)throw R?new Error(Z.dlsErrorAndCacheExpire):new Error(Z.checkLocalTime)};const te=new n;let re=null,ne=async(e,t)=>(P=P.then((async()=>{try{let r=await O.keys();if(t||(te.isFulfilled?e&&(r=r.filter((t=>t<e))):e&&r.includes(e)?r=[e]:(r=[],G("Unexpected null key"))),!r.length)return;for(let e=0;e<r.length/1e3;++e){let t=r.slice(1e3*e,1e3*(e+1)),n=[];for(let e=0;e<t.length;++e)n.push(await O.getItem(t[e]));S=(new Date).kUtilFormat("yyyy-MM-ddTHH:mm:ss.SSSZ");{let e=await g.getItem(L);e&&([c]=JSON.parse(await k(e))),g.setItem(L,await H(JSON.stringify([c,S])))}try{let e,r,o=U[0]+"verify/v2";S&&(o+="?ltstime="+encodeURIComponent(S));try{e=fetch(o,{method:"POST",body:n.join(";"),keepalive:!0})}finally{!te.isFulfilled&&E&&te.resolve()}try{r=await e}finally{te.isFulfilled||te.resolve()}if(!r.ok)throw new Error("verify failed. Status Code: "+r.status);for(let e=0;e<t.length;++e)await O.removeItem(t[e])}catch(e){throw te.isFulfilled||te.resolve(),e}}}catch(e){}})),await P);return{i:async e=>{r=e.pd,o=e.v,_=o.split(".")[0],e.dt&&(a=e.dt),i=e.l||"",I="string"!=typeof e.os?JSON.stringify(e.os):e.os,d=e.fn,"string"==typeof d&&(d=d.substring(0,255)),e.ls&&e.ls.length&&(U=e.ls,1==U.length&&U.push(U[0])),f=N===U&&(!i||"200001"===i||i.startsWith("200001-")),A=e.sp,m=e.rmk,"string"==typeof m&&(m=m.substring(0,255)),e.cv&&(D=""+e.cv),y=e.updl,b=e.mnet,M=e.mxet,await $(),await(async()=>{p=u(String.fromCharCode(i.charCodeAt(0)+10)+u(r)+u(i)+_+u(""+a)),O=await h.createInstance({name:"dynamdlsuns"+u(u("v2"))+u(String.fromCharCode(i.charCodeAt(0)+10)+u(r)+u(i)+_+u(""+a))});try{s=await g.getItem(p)}catch(e){}V=e=>l(String.fromCharCode.apply(null,e).replace(/\n/g,"+").replace(/\s/g,"="))})(),await Q(),await q(),(!R||R.ltsErrorCode>=102&&R.ltsErrorCode<=120)&&ne(null,!0)},c:async()=>{let e=new Date;if(e.getTime()<J+36e4)return;let t=e.kUtilFormat("yyyy-MM-ddTHH:mm:ss.SSSZ"),r=await b(),n=await M();if(n&&n<t)await Q(!0),await q();else if(r&&r<t){let t=new Date(e.getTime());t.setMinutes(e.getMinutes()-6);let r=t.kUtilFormat("yyyy-MM-ddTHH:mm:ss.SSSZ");S<r&&Q().then((()=>q()))}},s:async(e,r,n,o)=>{try{let e;e=r.startsWith("{")&&r.endsWith("}")?await(async e=>{if(t[V(B.c)]&&t[V(B.c)][V(B.e)]&&t[V(B.c)][V(B.e)][V(B.f)]){let r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)r[t]=e.charCodeAt(t);let n=t.crypto.getRandomValues(new Uint8Array(12));v||(v=await x());let o=await t[V(B.c)][V(B.e)][V(B.h)]({name:V(B.g),[V(B.j)]:n,[V(B.l)]:128},v,r),_=new Uint8Array(o),i=new Uint8Array(n.length+_.length);return i.set(n),i.set(_,n.length),u(String.fromCharCode.apply(null,i))}})(r):r,e?(G("bs "+n),await O.setItem(n,e),G("ss "+n)):G("ept ecpt")}catch(e){}o&&(G("bd "+n),await ne(n,2==o),G("sd "+n)),re&&clearTimeout(re),re=setTimeout((async()=>{await ne()}),36e4)},p:te,u:async()=>(await $(),c)}};
/*!
     * Dynamsoft JavaScript Library
     * @product Dynamsoft Core JS Edition
     * @website https://www.dynamsoft.com
     * @copyright Copyright 2023, Dynamsoft Corporation
     * @author Dynamsoft
     * @version 3.0.10
     * @fileoverview Dynamsoft JavaScript Library for Core
     * More info on DC JS: https://www.dynamsoft.com/core/docs/programming/javascript/?ver=latest
     */var Q,q,ee,te,re,ne,oe,_e,ie,se,ae,Ee,ce,Ie,de;"function"==typeof SuppressedError&&SuppressedError,(te=Q||(Q={}))[te.BOPM_BLOCK=0]="BOPM_BLOCK",te[te.BOPM_UPDATE=1]="BOPM_UPDATE",function(e){e[e.CCUT_AUTO=0]="CCUT_AUTO",e[e.CCUT_FULL_CHANNEL=1]="CCUT_FULL_CHANNEL",e[e.CCUT_Y_CHANNEL_ONLY=2]="CCUT_Y_CHANNEL_ONLY",e[e.CCUT_RGB_R_CHANNEL_ONLY=3]="CCUT_RGB_R_CHANNEL_ONLY",e[e.CCUT_RGB_G_CHANNEL_ONLY=4]="CCUT_RGB_G_CHANNEL_ONLY",e[e.CCUT_RGB_B_CHANNEL_ONLY=5]="CCUT_RGB_B_CHANNEL_ONLY"}(q||(q={})),function(e){e[e.IPF_BINARY=0]="IPF_BINARY",e[e.IPF_BINARYINVERTED=1]="IPF_BINARYINVERTED",e[e.IPF_GRAYSCALED=2]="IPF_GRAYSCALED",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888",e[e.IPF_BINARY_8=13]="IPF_BINARY_8",e[e.IPF_NV12=14]="IPF_NV12"}(ee||(ee={})),function(e){e[e.CRIT_ORIGINAL_IMAGE=1]="CRIT_ORIGINAL_IMAGE",e[e.CRIT_BARCODE=2]="CRIT_BARCODE",e[e.CRIT_TEXT_LINE=4]="CRIT_TEXT_LINE",e[e.CRIT_DETECTED_QUAD=8]="CRIT_DETECTED_QUAD",e[e.CRIT_NORMALIZED_IMAGE=16]="CRIT_NORMALIZED_IMAGE",e[e.CRIT_PARSED_RESULT=32]="CRIT_PARSED_RESULT"}(re||(re={})),function(e){e[e.CT_NORMAL_INTERSECTED=0]="CT_NORMAL_INTERSECTED",e[e.CT_T_INTERSECTED=1]="CT_T_INTERSECTED",e[e.CT_CROSS_INTERSECTED=2]="CT_CROSS_INTERSECTED",e[e.CT_NOT_INTERSECTED=3]="CT_NOT_INTERSECTED"}(ne||(ne={})),function(e){e[e.EC_OK=0]="EC_OK",e[e.EC_UNKNOWN=-1e4]="EC_UNKNOWN",e[e.EC_NO_MEMORY=-10001]="EC_NO_MEMORY",e[e.EC_NULL_POINTER=-10002]="EC_NULL_POINTER",e[e.EC_LICENSE_INVALID=-10003]="EC_LICENSE_INVALID",e[e.EC_LICENSE_EXPIRED=-10004]="EC_LICENSE_EXPIRED",e[e.EC_FILE_NOT_FOUND=-10005]="EC_FILE_NOT_FOUND",e[e.EC_FILE_TYPE_NOT_SUPPORTED=-10006]="EC_FILE_TYPE_NOT_SUPPORTED",e[e.EC_BPP_NOT_SUPPORTED=-10007]="EC_BPP_NOT_SUPPORTED",e[e.EC_INDEX_INVALID=-10008]="EC_INDEX_INVALID",e[e.EC_CUSTOM_REGION_INVALID=-10010]="EC_CUSTOM_REGION_INVALID",e[e.EC_IMAGE_READ_FAILED=-10012]="EC_IMAGE_READ_FAILED",e[e.EC_TIFF_READ_FAILED=-10013]="EC_TIFF_READ_FAILED",e[e.EC_DIB_BUFFER_INVALID=-10018]="EC_DIB_BUFFER_INVALID",e[e.EC_PDF_READ_FAILED=-10021]="EC_PDF_READ_FAILED",e[e.EC_PDF_DLL_MISSING=-10022]="EC_PDF_DLL_MISSING",e[e.EC_PAGE_NUMBER_INVALID=-10023]="EC_PAGE_NUMBER_INVALID",e[e.EC_CUSTOM_SIZE_INVALID=-10024]="EC_CUSTOM_SIZE_INVALID",e[e.EC_TIMEOUT=-10026]="EC_TIMEOUT",e[e.EC_JSON_PARSE_FAILED=-10030]="EC_JSON_PARSE_FAILED",e[e.EC_JSON_TYPE_INVALID=-10031]="EC_JSON_TYPE_INVALID",e[e.EC_JSON_KEY_INVALID=-10032]="EC_JSON_KEY_INVALID",e[e.EC_JSON_VALUE_INVALID=-10033]="EC_JSON_VALUE_INVALID",e[e.EC_JSON_NAME_KEY_MISSING=-10034]="EC_JSON_NAME_KEY_MISSING",e[e.EC_JSON_NAME_VALUE_DUPLICATED=-10035]="EC_JSON_NAME_VALUE_DUPLICATED",e[e.EC_TEMPLATE_NAME_INVALID=-10036]="EC_TEMPLATE_NAME_INVALID",e[e.EC_JSON_NAME_REFERENCE_INVALID=-10037]="EC_JSON_NAME_REFERENCE_INVALID",e[e.EC_PARAMETER_VALUE_INVALID=-10038]="EC_PARAMETER_VALUE_INVALID",e[e.EC_DOMAIN_NOT_MATCH=-10039]="EC_DOMAIN_NOT_MATCH",e[e.EC_RESERVED_INFO_NOT_MATCH=-10040]="EC_RESERVED_INFO_NOT_MATCH",e[e.EC_LICENSE_KEY_NOT_MATCHED=-10043]="EC_LICENSE_KEY_NOT_MATCHED",e[e.EC_REQUEST_FAILED=-10044]="EC_REQUEST_FAILED",e[e.EC_LICENSE_INIT_FAILED=-10045]="EC_LICENSE_INIT_FAILED",e[e.EC_SET_MODE_ARGUMENT_ERROR=-10051]="EC_SET_MODE_ARGUMENT_ERROR",e[e.EC_LICENSE_CONTENT_INVALID=-10052]="EC_LICENSE_CONTENT_INVALID",e[e.EC_LICENSE_KEY_INVALID=-10053]="EC_LICENSE_KEY_INVALID",e[e.EC_LICENSE_DEVICE_RUNS_OUT=-10054]="EC_LICENSE_DEVICE_RUNS_OUT",e[e.EC_GET_MODE_ARGUMENT_ERROR=-10055]="EC_GET_MODE_ARGUMENT_ERROR",e[e.EC_IRT_LICENSE_INVALID=-10056]="EC_IRT_LICENSE_INVALID",e[e.EC_FILE_SAVE_FAILED=-10058]="EC_FILE_SAVE_FAILED",e[e.EC_STAGE_TYPE_INVALID=-10059]="EC_STAGE_TYPE_INVALID",e[e.EC_IMAGE_ORIENTATION_INVALID=-10060]="EC_IMAGE_ORIENTATION_INVALID",e[e.EC_CONVERT_COMPLEX_TEMPLATE_ERROR=-10061]="EC_CONVERT_COMPLEX_TEMPLATE_ERROR",e[e.EC_CALL_REJECTED_WHEN_CAPTURING=-10062]="EC_CALL_REJECTED_WHEN_CAPTURING",e[e.EC_NO_IMAGE_SOURCE=-10063]="EC_NO_IMAGE_SOURCE",e[e.EC_READ_DIRECTORY_FAILED=-10064]="EC_READ_DIRECTORY_FAILED",e[e.EC_MODULE_NOT_FOUND=-10065]="EC_MODULE_NOT_FOUND",e[e.EC_MULTI_PAGES_NOT_SUPPORTED=-10066]="EC_MULTI_PAGES_NOT_SUPPORTED",e[e.EC_NO_LICENSE=-2e4]="EC_NO_LICENSE",e[e.EC_HANDSHAKE_CODE_INVALID=-20001]="EC_HANDSHAKE_CODE_INVALID",e[e.EC_LICENSE_BUFFER_FAILED=-20002]="EC_LICENSE_BUFFER_FAILED",e[e.EC_LICENSE_SYNC_FAILED=-20003]="EC_LICENSE_SYNC_FAILED",e[e.EC_DEVICE_NOT_MATCH=-20004]="EC_DEVICE_NOT_MATCH",e[e.EC_BIND_DEVICE_FAILED=-20005]="EC_BIND_DEVICE_FAILED",e[e.EC_INSTANCE_COUNT_OVER_LIMIT=-20008]="EC_INSTANCE_COUNT_OVER_LIMIT",e[e.EC_TRIAL_LICENSE=-20010]="EC_TRIAL_LICENSE",e[e.EC_LICENSE_VERSION_NOT_MATCH=-20011]="EC_LICENSE_VERSION_NOT_MATCH",e[e.EC_FAILED_TO_REACH_DLS=-20200]="EC_FAILED_TO_REACH_DLS",e[e.EC_BARCODE_FORMAT_INVALID=-30009]="EC_BARCODE_FORMAT_INVALID",e[e.EC_QR_LICENSE_INVALID=-30016]="EC_QR_LICENSE_INVALID",e[e.EC_1D_LICENSE_INVALID=-30017]="EC_1D_LICENSE_INVALID",e[e.EC_PDF417_LICENSE_INVALID=-30019]="EC_PDF417_LICENSE_INVALID",e[e.EC_DATAMATRIX_LICENSE_INVALID=-30020]="EC_DATAMATRIX_LICENSE_INVALID",e[e.EC_CUSTOM_MODULESIZE_INVALID=-30025]="EC_CUSTOM_MODULESIZE_INVALID",e[e.EC_AZTEC_LICENSE_INVALID=-30041]="EC_AZTEC_LICENSE_INVALID",e[e.EC_PATCHCODE_LICENSE_INVALID=-30046]="EC_PATCHCODE_LICENSE_INVALID",e[e.EC_POSTALCODE_LICENSE_INVALID=-30047]="EC_POSTALCODE_LICENSE_INVALID",e[e.EC_DPM_LICENSE_INVALID=-30048]="EC_DPM_LICENSE_INVALID",e[e.EC_FRAME_DECODING_THREAD_EXISTS=-30049]="EC_FRAME_DECODING_THREAD_EXISTS",e[e.EC_STOP_DECODING_THREAD_FAILED=-30050]="EC_STOP_DECODING_THREAD_FAILED",e[e.EC_MAXICODE_LICENSE_INVALID=-30057]="EC_MAXICODE_LICENSE_INVALID",e[e.EC_GS1_DATABAR_LICENSE_INVALID=-30058]="EC_GS1_DATABAR_LICENSE_INVALID",e[e.EC_GS1_COMPOSITE_LICENSE_INVALID=-30059]="EC_GS1_COMPOSITE_LICENSE_INVALID",e[e.EC_DOTCODE_LICENSE_INVALID=-30061]="EC_DOTCODE_LICENSE_INVALID",e[e.EC_PHARMACODE_LICENSE_INVALID=-30062]="EC_PHARMACODE_LICENSE_INVALID",e[e.EC_CHARACTER_MODEL_FILE_NOT_FOUND=-40100]="EC_CHARACTER_MODEL_FILE_NOT_FOUND",e[e.EC_QUADRILATERAL_INVALID=-50057]="EC_QUADRILATERAL_INVALID",e[e.EC_CAMERA_MODULE_NOT_EXIST=-60003]="EC_CAMERA_MODULE_NOT_EXIST",e[e.EC_CAMERA_ID_NOT_EXIST=-60006]="EC_CAMERA_ID_NOT_EXIST",e[e.EC_NO_SENSOR=-60045]="EC_NO_SENSOR",e[e.EC_PANORAMA_LICENSE_INVALID=-70060]="EC_PANORAMA_LICENSE_INVALID",e[e.EC_RESOURCE_PATH_NOT_EXIST=-90001]="EC_RESOURCE_PATH_NOT_EXIST",e[e.EC_RESOURCE_LOAD_FAILED=-90002]="EC_RESOURCE_LOAD_FAILED",e[e.EC_CODE_SPECIFICATION_NOT_FOUND=-90003]="EC_CODE_SPECIFICATION_NOT_FOUND",e[e.EC_FULL_CODE_EMPTY=-90004]="EC_FULL_CODE_EMPTY",e[e.EC_FULL_CODE_PREPROCESS_FAILED=-90005]="EC_FULL_CODE_PREPROCESS_FAILED",e[e.EC_ZA_DL_LICENSE_INVALID=-90006]="EC_ZA_DL_LICENSE_INVALID",e[e.EC_AAMVA_DL_ID_LICENSE_INVALID=-90007]="EC_AAMVA_DL_ID_LICENSE_INVALID",e[e.EC_AADHAAR_LICENSE_INVALID=-90008]="EC_AADHAAR_LICENSE_INVALID",e[e.EC_MRTD_LICENSE_INVALID=-90009]="EC_MRTD_LICENSE_INVALID",e[e.EC_VIN_LICENSE_INVALID=-90010]="EC_VIN_LICENSE_INVALID",e[e.EC_CUSTOMIZED_CODE_TYPE_LICENSE_INVALID=-90011]="EC_CUSTOMIZED_CODE_TYPE_LICENSE_INVALID"}(oe||(oe={})),function(e){e[e.GEM_SKIP=0]="GEM_SKIP",e[e.GEM_AUTO=1]="GEM_AUTO",e[e.GEM_GENERAL=2]="GEM_GENERAL",e[e.GEM_GRAY_EQUALIZE=4]="GEM_GRAY_EQUALIZE",e[e.GEM_GRAY_SMOOTH=8]="GEM_GRAY_SMOOTH",e[e.GEM_SHARPEN_SMOOTH=16]="GEM_SHARPEN_SMOOTH",e[e.GEM_REV=-2147483648]="GEM_REV"}(_e||(_e={})),function(e){e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_AUTO=4]="GTM_AUTO",e[e.GTM_REV=-2147483648]="GTM_REV"}(ie||(ie={})),function(e){e[e.ITT_FILE_IMAGE=0]="ITT_FILE_IMAGE",e[e.ITT_VIDEO_FRAME=1]="ITT_VIDEO_FRAME"}(se||(se={})),function(e){e[e.PDFRM_VECTOR=1]="PDFRM_VECTOR",e[e.PDFRM_RASTER=2]="PDFRM_RASTER",e[e.PDFRM_REV=-2147483648]="PDFRM_REV"}(ae||(ae={})),function(e){e[e.RDS_RASTERIZED_PAGES=0]="RDS_RASTERIZED_PAGES",e[e.RDS_EXTRACTED_IMAGES=1]="RDS_EXTRACTED_IMAGES"}(Ee||(Ee={})),function(e){e[e.IRUT_NULL=0]="IRUT_NULL",e[e.IRUT_COLOUR_IMAGE=1]="IRUT_COLOUR_IMAGE",e[e.IRUT_SCALED_DOWN_COLOUR_IMAGE=2]="IRUT_SCALED_DOWN_COLOUR_IMAGE",e[e.IRUT_GRAYSCALE_IMAGE=4]="IRUT_GRAYSCALE_IMAGE",e[e.IRUT_TRANSOFORMED_GRAYSCALE_IMAGE=8]="IRUT_TRANSOFORMED_GRAYSCALE_IMAGE",e[e.IRUT_ENHANCED_GRAYSCALE_IMAGE=16]="IRUT_ENHANCED_GRAYSCALE_IMAGE",e[e.IRUT_PREDETECTED_REGIONS=32]="IRUT_PREDETECTED_REGIONS",e[e.IRUT_BINARY_IMAGE=64]="IRUT_BINARY_IMAGE",e[e.IRUT_TEXTURE_DETECTION_RESULT=128]="IRUT_TEXTURE_DETECTION_RESULT",e[e.IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE=256]="IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE",e[e.IRUT_TEXTURE_REMOVED_BINARY_IMAGE=512]="IRUT_TEXTURE_REMOVED_BINARY_IMAGE",e[e.IRUT_CONTOURS=1024]="IRUT_CONTOURS",e[e.IRUT_LINE_SEGMENTS=2048]="IRUT_LINE_SEGMENTS",e[e.IRUT_TEXT_ZONES=4096]="IRUT_TEXT_ZONES",e[e.IRUT_TEXT_REMOVED_BINARY_IMAGE=8192]="IRUT_TEXT_REMOVED_BINARY_IMAGE",e[e.IRUT_CANDIDATE_BARCODE_ZONES=16384]="IRUT_CANDIDATE_BARCODE_ZONES",e[e.IRUT_LOCALIZED_BARCODES=32768]="IRUT_LOCALIZED_BARCODES",e[e.IRUT_SCALED_UP_BARCODE_IMAGE=65536]="IRUT_SCALED_UP_BARCODE_IMAGE",e[e.IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE=131072]="IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE",e[e.IRUT_COMPLEMENTED_BARCODE_IMAGE=262144]="IRUT_COMPLEMENTED_BARCODE_IMAGE",e[e.IRUT_DECODED_BARCODES=524288]="IRUT_DECODED_BARCODES",e[e.IRUT_LONG_LINES=1048576]="IRUT_LONG_LINES",e[e.IRUT_CORNERS=2097152]="IRUT_CORNERS",e[e.IRUT_CANDIDATE_QUAD_EDGES=4194304]="IRUT_CANDIDATE_QUAD_EDGES",e[e.IRUT_DETECTED_QUADS=8388608]="IRUT_DETECTED_QUADS",e[e.IRUT_LOCALIZED_TEXT_LINES=16777216]="IRUT_LOCALIZED_TEXT_LINES",e[e.IRUT_RECOGNIZED_TEXT_LINES=33554432]="IRUT_RECOGNIZED_TEXT_LINES",e[e.IRUT_NORMALIZED_IMAGES=67108864]="IRUT_NORMALIZED_IMAGES",e[e.IRUT_ALL=134217727]="IRUT_ALL"}(ce||(ce={})),function(e){e[e.ROET_PREDETECTED_REGION=0]="ROET_PREDETECTED_REGION",e[e.ROET_LOCALIZED_BARCODE=1]="ROET_LOCALIZED_BARCODE",e[e.ROET_DECODED_BARCODE=2]="ROET_DECODED_BARCODE",e[e.ROET_LOCALIZED_TEXT_LINE=3]="ROET_LOCALIZED_TEXT_LINE",e[e.ROET_RECOGNIZED_TEXT_LINE=4]="ROET_RECOGNIZED_TEXT_LINE",e[e.ROET_DETECTED_QUAD=5]="ROET_DETECTED_QUAD",e[e.ROET_NORMALIZED_IMAGE=6]="ROET_NORMALIZED_IMAGE"}(Ie||(Ie={})),function(e){e[e.ST_NULL=0]="ST_NULL",e[e.ST_REGION_PREDETECTION=1]="ST_REGION_PREDETECTION",e[e.ST_BARCODE_LOCALIZATION=2]="ST_BARCODE_LOCALIZATION",e[e.ST_BARCODE_DECODING=3]="ST_BARCODE_DECODING",e[e.ST_TEXT_LINE_LOCALIZATION=4]="ST_TEXT_LINE_LOCALIZATION",e[e.ST_TEXT_LINE_RECOGNITION=5]="ST_TEXT_LINE_RECOGNITION",e[e.ST_DOCUMENT_DETECTION=6]="ST_DOCUMENT_DETECTION",e[e.ST_DOCUMENT_NORMALIZATION=7]="ST_DOCUMENT_NORMALIZATION"}(de||(de={}));const ue=t;let le,Ce,Te,Ne,fe,Ae,me,De,Se=self,Re=new Map,he=0;const Oe=[];t.KModule=t.Module={print:e=>{xe(e)},printErr:e=>{xe(e)}};let ge=new n,Le=null,pe=null,ye=!1;const be=async e=>{await ge,Ae=e.trial,me=e.msg,Module.CoreWasm.init(JSON.stringify(e))},Me=()=>{let e=Module.CoreWasm.getMinExpireTime;return e?e():null},ve=()=>{let e=Module.CoreWasm.getMaxExpireTime;return e?e():null},Ue=e=>{if(!Re.get(e))throw new Error("Instance does not exist.")},we={dbr:"dynamsoft-javascript-barcode",dlr:"dynamsoft-label-recognizer",ddn:"dynamsoft-document-normalizer",dcp:"dynamsoft-code-parser"},Pe=async e=>{if(!e.length)return;let t=Ne;e.forEach((e=>{t=`https://cdn.jsdelivr.net/npm/${we[e]}/dist/`,Module.dynamicLibraries.includes(`${t}${e}.wasm`)||Module.dynamicLibraries.push(`${t}${e}.wasm`)})),await Module.preloadDylibs();for(let t=0;t<e.length;t++){const r=e[t];Se.ensureCache.prepare(),Se._emscripten_bind_CvrWasm_SetModuleExist(Se.ensureString(r.toUpperCase()))}},Fe=(e,t,r)=>{const n=Re.get(r);Se.ensureCache.prepare();const o=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_OutputSettings_1(n,Se.ensureString(t))));o.ImageParameterOptions[0].BinarizationModes[0].EnableFillBinaryVacancy=e?0:1,o.ImageParameterOptions[0].BinarizationModes[0].BlockSizeX=e?71:0,o.ImageParameterOptions[0].BinarizationModes[0].BlockSizeY=e?71:0,Se.ensureCache.prepare(),Se.UTF8ToString(Se._emscripten_bind_CvrWasm_InitSettings_1(n,Se.ensureString(JSON.stringify(o))))},Ge={loadWasm:async(e,r,n,o)=>{try{Te=e.bd,Ce=e.v;let r=e.dm,n=e.l;fe=e.brtk;let o,_=e.bptk;Ne=e.engineResourcePath,await(async()=>{if(ye)throw"can't load wasm twice.";ye=!0,Module.dynamicLibraries=[],Module.locateFile=function(e,t){return Ne+e},xe("wasm loading...");const e=Date.now();await new Promise((async e=>{Module.onRuntimeInitialized=async()=>{Se.ensureCache.prepare(),Se._emscripten_bind_CvrWasm_SetModuleExist(Se.ensureString("DIP")),e()},importScripts(Ne+"cvr.wasm.js"),importScripts(Ne+"cvr_wasm_glue.js")})),xe("wasm initialized, cost "+(Date.now()-e)+" ms"),ge.resolve()})();let i=async()=>{try{De=$({log:xe,bd:Te,dm:r}),t.scsd=De.s,e.pd="",e.v=Ce,e.updl=be,e.mnet=Me,e.mxet=ve,await De.i(e)}catch(e){if(!_)throw e;fe=!1,await s(),o=e.ltsErrorCode,me=e.message||e}},s=async()=>{let e={pk:n,dm:r};Te&&(e.bd=!0),await be(e)};fe?await i():await s();const a=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetModuleVersion_0()));let E="No Have Device UUID.";De&&De.u&&(E=await De.u()),ue.postMessage({type:"load",success:!0,moduleVersion:a,version:a.CVR,trial:Ae,ltsErrorCode:o,message:me,DeviceUUID:E,bSupportDce4Module:Module.CoreWasm.getIsSupportDceModule()})}catch(e){let t=e&&e.message;ue.postMessage({type:"load",success:!1,ltsErrorCode:e&&e.ltsErrorCode,message:t,trial:Ae,stack:Te&&e?e.stack:null})}},preloadModule:async(e,t,r,o)=>{try{Le=new n,await Pe(t.modules)}catch(e){return void Be(r,e)}finally{Le.resolve()}Ve(r,{success:!0})},isModuleLoaded:async(e,t,r,n)=>{const o={success:!0,isModuleLoaded:Module[`${t.moduleName}`]};Ve(r,o)},createInstance:async(e,t,r)=>{const n=he++;try{let e=Se._emscripten_bind_CvrWasm_CvrWasm_0();Re.set(n,e)}catch(e){return void Be(r,e)}Ve(r,{success:!0,instanceID:n})},dispose:async(e,t,r,n)=>{try{Ue(n),Se._emscripten_bind_Destory_CImageData(le),le=null,Se._emscripten_bind_CvrWasm___destroy___0(Re.get(n)),Re.delete(n)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},startCapturing:async(e,t,r,n)=>{try{Ue(n),Le&&Le.isPending&&await Le,await Pe(t.modules);for(let e=0;e<t.modules.length;e++)if(!Module[`${t.modules[e]}`])throw new Error(`'${t.modules[e]}' module load failed.`)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},capture:async(e,t,r,n)=>{let o,_;await(async()=>{fe&&De&&await De.c()})();try{Ue(n),pe&&pe.isPending&&await pe,le&&(Se._emscripten_bind_Destory_CImageData(le),le=null),le=Se._emscripten_bind_Create_CImageData(t.bytes.length,((e,t=0,r=0,n=0)=>{r&&(e=n?e.subarray(r,n):e.subarray(r));let o=Oe[t]=Oe[t]||{ptr:0,size:0,maxSize:0};return e.length>o.maxSize&&(o.ptr&&Module._free(o.ptr),o.ptr=Module._malloc(e.length),o.maxSize=e.length),Module.HEAPU8.set(e,o.ptr),o.size=e.length,o.ptr})(t.bytes,0),t.width,t.height,4*t.width,10,0),Se.ensureCache.prepare(),o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_Capture_3(Re.get(n),le,Se.ensureString(t.templateName),t.bScanner)),o=JSON.parse(o);for(let e=0;e<o.items.length;e++)o.items[e].type===re.CRIT_NORMALIZED_IMAGE&&(_=o.items[e].imageData.bytes,_=new Uint8Array(new Uint8Array(Module.HEAP8.buffer,_.ptr,_.length)),o.items[e].imageData.bytes=_)}catch(e){return void Be(r,e)}const i={success:!0,bytes:t.bytes,captureResult:o},s=[t.bytes.buffer];ue.postMessage({type:"task",id:r,body:i},s)},getIntermediateResult:async(e,t,r,n)=>{let o,_,i,s={};try{Se.ensureCache.prepare(),o=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetIntermediateResult_0(Re.get(n)))),_=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetSectionSet_0(Re.get(n)))),i=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetStageSet_0(Re.get(n)))),s.taskSet=o,s.sectionSet=_,s.stageSet=i,s=JSON.stringify(s)}catch(e){return void Be(r,e)}Ve(r,{success:!0,result:s})},initSettings:async(e,t,r,o)=>{let _;try{Ue(o),Le&&Le.isPending&&await Le,pe=new n,await Pe(t.modules),Se.ensureCache.prepare(),_=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_InitSettings_1(Re.get(o),Se.ensureString(t.settings)))}catch(e){return void Be(r,e)}finally{pe.resolve()}Ve(r,{success:!0,response:_})},outputSettings:async(e,t,r,n)=>{let o;try{Se.ensureCache.prepare(),o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_OutputSettings_1(Re.get(n),Se.ensureString(t.templateName)))}catch(e){return void Be(r,e)}Ve(r,{success:!0,settings:o})},getSimplifiedSettings:async(e,t,r,n)=>{let o;try{Se.ensureCache.prepare(),o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetSimplifiedSettings_1(Re.get(n),Se.ensureString(t.templateName)))}catch(e){return void Be(r,e)}Ve(r,{success:!0,settings:o})},updateSettings:async(e,t,r,n)=>{let o;try{Ue(n);const e=["speed","balance","coverage","dense","distance"],r=["numberletter","numberuppercase","number","letter","mrz","passportmrz","visamrz","idcardmrz","vin_na","vin"];let _=t.settings;const i=t.templateName;"string"==typeof _&&(e.includes(_.toLowerCase())?_=((e,t,r)=>{const n=Re.get(r);Se.ensureCache.prepare();const o=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetSimplifiedSettings_1(n,Se.ensureString(t))));Se.UTF8ToString(Se._emscripten_bind_CvrWasm_ResetSettings_0(n)),Se.ensureCache.prepare();const _=JSON.parse(Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetSimplifiedSettings_1(n,Se.ensureString(t))));return _.barcodeSettings.barcodeFormatIds=o.barcodeSettings.barcodeFormatIds,"speed"===e?(Fe(!0,t,r),_.barcodeSettings.expectedBarcodesCount=0,_.barcodeSettings.localizationModes=[2,0,0,0,0,0,0,0]):"balance"===e?(Fe(!0,t,r),_.barcodeSettings.expectedBarcodesCount=512,_.barcodeSettings.localizationModes=[2,16,0,0,0,0,0,0],_.barcodeSettings.deblurModes=[128,2,1,0,0,0,0,0],_.timeout=1e5):"coverage"===e?(Fe(!1,t,r),_.barcodeSettings.expectedBarcodesCount=512,_.barcodeSettings.localizationModes=[2,16,6,8,0,0,0,0],_.barcodeSettings.deblurModes=[128,2,1,8,0,0,0,0],_.timeout=1e5):"dense"===e?(Fe(!1,t,r),_.barcodeSettings.minResultConfidence=0,_.barcodeSettings.expectedBarcodesCount=0,_.barcodeSettings.localizationModes=[2,8,0,0,0,0,0,0],_.barcodeSettings.deblurModes=[128,2,1,8,4,0,0,0],_.timeout=1e5):"distance"===e&&(Fe(!1,t,r),_.barcodeSettings.expectedBarcodesCount=0,_.barcodeSettings.localizationModes=[2,0,0,0,0,0,0,0],_.timeout=1e5),_})(_,i,n):r.includes(_.toLowerCase())&&(_=await(async(e,t,r)=>{})())),"object"==typeof _&&_.hasOwnProperty("barcodeSettings")&&(_.barcodeSettings.barcodeFormatIds=_.barcodeSettings.barcodeFormatIds.toString()),Se.ensureCache.prepare(),o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_UpdateSettings_2(Re.get(n),Se.ensureString(i),Se.ensureString(JSON.stringify(_))))}catch(e){return void Be(r,e)}Ve(r,{success:!0,response:o})},resetSettings:async(e,t,r,n)=>{let o;try{Ue(n),o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_ResetSettings_0(Re.get(n)))}catch(e){return void Be(r,e)}Ve(r,{success:!0,response:o})},getModuleVersion:async(e,t,r,n)=>{let o;try{o=Se.UTF8ToString(Se._emscripten_bind_CvrWasm_GetModuleVersion_0())}catch(e){return void Be(r,e)}Ve(r,{success:!0,version:o})},enableResultCrossVerification:async(e,t,r,n)=>{try{Ue(n),Se._emscripten_bind_CvrWasm_EnableResultCrossVerification_2(Re.get(n),t.type,t.enabled)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},enableResultDeduplication:async(e,t,r,n)=>{try{Ue(n),Se._emscripten_bind_CvrWasm_EnableResultDeduplication_2(Re.get(n),t.type,t.enabled)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},setDuplicateForgetTime:async(e,t,r,n)=>{try{Ue(n),Se._emscripten_bind_CvrWasm_SetDuplicateForgetTime_2(Re.get(n),t.type,t.time)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},getDuplicateForgetTime:async(e,t,r,n)=>{let o;try{Ue(n),o=Se._emscripten_bind_CvrWasm_GetDuplicateForgetTime_1(Re.get(n),t.type)}catch(e){return void Be(r,e)}Ve(r,{success:!0,time:o})},setIrrRegistry:async(e,t,r,n)=>{try{Ue(n),Se.ensureCache.prepare(),Se._emscripten_bind_CvrWasm_SetIrrRegistry_1(Re.get(n),Se.ensureString(JSON.stringify(t.receiverObj)))}catch(e){return void Be(r,e)}Ve(r,{success:!0})},setCrrRegistry:async(e,t,r,n)=>{try{Ue(n),Se.ensureCache.prepare(),Se._emscripten_bind_CvrWasm_SetCrrRegistry_1(Re.get(n),Se.ensureString(t.receiver))}catch(e){return void Be(r,e)}Ve(r,{success:!0})},consumeForDce:async(e,t,r,n)=>{try{Module.CoreWasm.consumeForDce(t.count)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},setThresholdValue:async(e,t,r,n)=>{try{Se._emscripten_bind_CvrWasm_SetThresholdValue_3(Re.get(n),t.threshold,t.leftLimit,t.rightLimit)}catch(e){return void Be(r,e)}Ve(r,{success:!0})},clearVerifyList:async(e,t,r,n)=>{try{Se._emscripten_bind_CvrWasm_ClearVerifyList_0(Re.get(n))}catch(e){return void Be(r,e)}Ve(r,{success:!0})}};ue.onmessage=function(e){const t=e.data?e.data:e,r=t.body,n=t.id,o=t.instanceID,_=Ge[t.type];Ge[t.type]?_(t,r,n,o):console.warn("Unmatched task: ",e)};const Ve=(e,t)=>{ue.postMessage({type:"task",id:e,body:t})},Be=(e,t)=>{ue.postMessage({type:"task",id:e,body:{success:!1,message:t.message,stack:t.stack}}),setTimeout((()=>{throw t}),0)},xe=e=>{ue.postMessage({type:"log",message:e})}}();
